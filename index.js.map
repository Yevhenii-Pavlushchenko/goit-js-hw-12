{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api';\nconst API_KEY = '54685682-80977b0b5ca1319a1902ced87';\nexport const perPage = 15;\naxios.defaults.baseURL = BASE_URL;\n\nexport async function getImagesByQuery(query, page) {\n  const response = await axios({\n    url: BASE_URL,\n    method: 'get',\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page,\n      per_page: perPage,\n    },\n  });\n  return response.data;\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst gallery = document.querySelector('.gallery');\nexport const loadBtn = document.querySelector('.gallery-btn');\nconst loader = document.querySelector('.loader');\n\nlet lightBox = null;\n\nexport function createGallery(images) {\n  const markup = images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `\n            <li class=\"list-item\">\n                <a href=\"${largeImageURL}\"><img src=\"${webformatURL}\" alt=\"${tags}\" /></a>\n                <div class=\"list-content\">\n                    <div>\n                        <h2 class=\"likes\">Likes</h2>\n                        <p class=\"count-likes\">${likes}</p>\n                    </div>\n                    <div>\n                        <h2 class=\"views\">Views</h2>\n                        <p class=\"count-views\">${views}</p>\n                    </div>\n                    <div>\n                        <h2 class=\"comments\">Comments</h2>\n                        <p class=\"count-comments\">${comments}</p>\n                    </div>\n                    <div>\n                        <h2 class=\"downloads\">Downloads</h2>\n                        <p class=\"count-downloads\">${downloads}</p>\n                    </div>\n                </div>\n            </li>\n        `;\n      }\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n\n  if (lightBox) {\n    lightBox.refresh();\n  } else {\n    lightBox = new SimpleLightbox('.gallery a', {\n      captions: true,\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n  }\n}\nexport function clearGallery() {\n  gallery.innerHTML = '';\n}\nexport function showLoader() {\n  loader.classList.remove('is-hidden');\n}\nexport function hideLoader() {\n  loader.classList.add('is-hidden');\n}\n\nexport function showLoadMoreButton() {\n  loadBtn.classList.remove('is-hidden');\n  // return;\n}\nexport function hideLoadMoreButton() {\n  loadBtn.classList.add('is-hidden');\n  // return;\n}\n","import { perPage, getImagesByQuery } from './js/pixabay-api';\nimport {\n  createGallery,\n  hideLoader,\n  hideLoadMoreButton,\n  loadBtn,\n  showLoader,\n  showLoadMoreButton,\n  clearGallery,\n} from './js/render-functions';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst form = document.querySelector('.form');\nconst outputTotal = document.querySelector('.output-total');\nconst scrollTopBtn = document.querySelector('#scrollToTop');\n\nform.addEventListener('submit', onSubmitForm);\nloadBtn.addEventListener('click', onLoadMoreClick);\n\nlet inputValue = '';\nlet pageNum = 1;\nlet totalPages = 0;\nlet imagesCount = 0;\n\nhideLoader();\n\nasync function onSubmitForm(event) {\n  event.preventDefault();\n  imagesCount = 0;\n  pageNum = 1;\n  hideLoadMoreButton();\n  clearGallery();\n\n  inputValue = form.elements['search-text'].value.trim();\n  try {\n    if (inputValue === '') {\n      iziToast.warning({\n        title: 'warning',\n        position: 'topRight',\n        message: 'Please enter a search query!',\n      });\n\n      outputTotal.textContent = ``;\n\n      hideLoadMoreButton();\n      hideLoader();\n      clearGallery();\n      return;\n    }\n\n    showLoader();\n    const { hits, totalHits } = await getImagesByQuery(inputValue, pageNum);\n    totalPages = Math.ceil(totalHits / perPage);\n\n    imagesCount += hits.length;\n    if (imagesCount > totalHits) {\n      imagesCount = totalHits;\n    }\n    outputTotal.textContent = `Total images: ${imagesCount}/${totalHits}`;\n\n    if (!hits || hits.length === 0) {\n      console.log(hits);\n      iziToast.show({\n        message:\n          ' Sorry, there are no images matching your search query. Please try again!',\n        backgroundColor: `#4e75ff`,\n        messageColor: `#ffffff`,\n        position: `topRight`,\n      });\n      hideLoader();\n      return;\n    }\n    createGallery(hits);\n    if (pageNum < totalPages) {\n      showLoadMoreButton();\n    }\n  } catch (error) {\n    hideLoadMoreButton();\n    console.log(error.message);\n  } finally {\n    form.elements['search-text'].value = '';\n    hideLoader();\n  }\n}\n\nasync function onLoadMoreClick() {\n  showLoader();\n  hideLoadMoreButton();\n  try {\n    pageNum += 1;\n    const { hits, totalHits } = await getImagesByQuery(inputValue, pageNum);\n\n    imagesCount += hits.length;\n    if (imagesCount > totalHits) {\n      imagesCount = totalHits;\n    }\n    outputTotal.textContent = `Total images: ${imagesCount}/${totalHits}`;\n    if (pageNum < totalPages) {\n      showLoadMoreButton();\n    } else {\n      iziToast.show({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        backgroundColor: `#4e75ff`,\n        messageColor: `#ffffff`,\n        position: `topRight`,\n      });\n      hideLoadMoreButton();\n    }\n\n    createGallery(hits);\n    scrollDownOnePage();\n  } catch (error) {\n    console.log(error);\n    iziToast.error({\n      message: error.message,\n      backgroundColor: `#4e75ff`,\n      messageColor: `#ffffff`,\n      position: `topRight`,\n    });\n  } finally {\n    hideLoader();\n  }\n}\n\nfunction scrollDownOnePage() {\n  const gallery = document.querySelector('.gallery');\n  if (!gallery.firstElementChild) return;\n  const { height } = gallery.firstElementChild.getBoundingClientRect();\n\n  scrollBy({\n    top: height * 2,\n    behavior: 'smooth',\n  });\n}\n\n// Скрол вгору при натисканні\nscrollTopBtn.addEventListener('click', () => {\n  window.scrollTo({\n    top: 0,\n    behavior: 'smooth',\n  });\n});\n\nwindow.addEventListener('scroll', () => {\n  if (window.scrollY > 500) {\n    scrollTopBtn.classList.add('is-visible');\n  } else {\n    scrollTopBtn.classList.remove('is-visible');\n  }\n});\n"],"names":["BASE_URL","API_KEY","perPage","axios","getImagesByQuery","query","page","gallery","loadBtn","loader","lightBox","createGallery","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","form","outputTotal","scrollTopBtn","onSubmitForm","onLoadMoreClick","inputValue","pageNum","totalPages","imagesCount","event","iziToast","hits","totalHits","error","scrollDownOnePage","height"],"mappings":"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"}